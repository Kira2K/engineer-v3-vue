extends ../layout.pug

block body
  - var instance = instance || {}
  .card: form(method='post' enctype='application/x-www-form-urlencoded')
    .card-header
      h3.card-title Новая номенклатурная позиция
    .card-body
      if instance.id
        .form-group
          label(for="id") Код
          input#id.form-control(type="text" placeholder="" disabled value=instance.id)
      .form-group
        label(for="nomenclatureModelId") Классификация номенклатуры
        select#nomenclatureModelId.form-control(name="nomenclatureModelId")
          option(value='') Класс > Группа > Тип > Модель
          each val in parent
            if instance.nomenclatureModelId == val.id
              option(selected value=val.id)= val['nt.ng.nc.title'] + ' > ' + val['nt.ng.title'] + ' > ' + val['nt.title'] + ' > ' + val.title

            else
              option(value=val.id)= val['nt.ng.nc.title'] + ' > ' + val['nt.ng.title'] + ' > ' + val['nt.title'] + ' > ' + val.title
      .form-group
        label(for="unitId") Единица измерения
        select#unitId.form-control(name="unitId")
          option(value='') ___
          each val in unit
            if instance.unitId == val.id
              option(selected value=val.id)= val.title + ' (' + val.short + ')'
            else
              option(value=val.id)= val.title + ' (' + val.short + ')'
      .form-group
        label(for="title") Наименование
        input#title.form-control(name="title" type="text" placeholder="" value=instance.title)
      .form-group
        label(for="designation") Обозначение
        input#short.form-control(name="designation" type="text" placeholder="" value=instance.designation)
      //each val in nomenclatureparameter
        - var id = `nomenclatureparameter_${val.id}`
        .form-group
          .custom-control.custom-switch
            if enabledparameters.find(el => el.nomenclatureParameterId == val.id)
              input.custom-control-input(id=id name=id type="checkbox" checked)
            else
              input.custom-control-input(id=id name=id type="checkbox")
            label.custom-control-label(for=id)= `${val.title} (${val['unit.short']})`
      .form-group
        label(for="enabledparameters") Параметры
        select#enabledparameters.form-control.select2(name="enabledparameters" multiple data-placeholder="Укажите параметры" style='height: 450px')
          option(value='') ___
          each val in nomenclatureparameter
            if enabledparameters.find(el => el.nomenclatureParameterId == val.id)
              option(selected value=val.id)= val.title + ' (' + val['unit.short'] + ')'
            else
              option(value=val.id)= val.title + ' (' + val['unit.short'] + ')'
    .card-footer
      if instance.id
        button.btn.btn-primary(type="submit") Сохранить
        a.float-right.btn.btn-danger(href=`/nomenclature/delete/${instance.id}`) Удалить
      else
        button.btn.btn-primary(type="submit") Добавить
